<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Youth.Views.SafeSpace.PostDetailsPage"
             Title="{Binding Title}"
             xmlns:local="clr-namespace:Youth.ViewModels"
             xmlns:model="clr-namespace:Youth.Models"
             xmlns:utils="clr-namespace:Youth.Utils"
             Shell.NavBarIsVisible="False"
             Shell.FlyoutItemIsVisible="False"
             Shell.FlyoutBehavior="Disabled"
             Shell.PresentationMode="Animated"
             Shell.TabBarIsVisible="False"
             xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
             xmlns:toolkitViews="clr-namespace:CommunityToolkit.Maui.Views;assembly=CommunityToolkit.Maui"
             ios:Page.UseSafeArea="true"
             xmlns:converters="clr-namespace:Youth.Helpers.Converters">

    <ContentPage.Resources>
        <Style TargetType="Frame">
            <Setter Property="HasShadow" Value="False"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="IsClippedToBounds" Value="True"/>
        </Style>
        <ResourceDictionary>
            <converters:IsImageSourceConverter x:Key="isImageSourceConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.Content>

        <StackLayout>

            <StackLayout
                Orientation="Horizontal"
                VerticalOptions="Center"
                Spacing="10"
                Grid.Row="0"
                Margin="10,20,10,0">

                <Image
                    HorizontalOptions="Start"
                    HeightRequest="30"
                    Source="back.png"
                    BackgroundColor="transparent"
                    VerticalOptions="CenterAndExpand">
                    <Image.GestureRecognizers>
                        <TapGestureRecognizer Tapped="Btn_Back"/>
                    </Image.GestureRecognizers>
                </Image>

                <Label Text="{Binding Title}"
                        HorizontalOptions="CenterAndExpand"
                        VerticalOptions="CenterAndExpand"
                        Style="{StaticResource TabHeader}"/>
                <Image Source="settings.png"
                        HorizontalOptions="End"
                        HeightRequest="30"
                        IsVisible="True">
                    <Image.Triggers>
                        <DataTrigger Binding="{Binding isRunning}" TargetType="Image" Value="True">
                            <Setter Property="IsVisible" Value="False"/>
                        </DataTrigger>
                    </Image.Triggers>
                </Image>

                <ActivityIndicator
                    x:Name="ActivityIndicator"
                    IsRunning="{Binding isRunning}"
                    HeightRequest="30"
                    WidthRequest="30"
                    HorizontalOptions="End"
                    Color="{StaticResource PrimaryDarkColor}"
                    IsVisible="False">
                    <ActivityIndicator.Triggers>
                        <DataTrigger Binding="{Binding isRunning}" TargetType="ActivityIndicator" Value="True">
                            <Setter Property="IsVisible" Value="True"/>
                        </DataTrigger>
                    </ActivityIndicator.Triggers>
                </ActivityIndicator>
            </StackLayout>

            <ScrollView VerticalScrollBarVisibility="Never" VerticalOptions="FillAndExpand">
                <StackLayout Padding="0,10,0,10"
                            Spacing="10">

                    <StackLayout Padding="5,0,5,0">
                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10">
                            <StackLayout Orientation="Vertical" Padding="5">

                                <StackLayout Orientation="Horizontal">
                                    <toolkitViews:AvatarView VerticalOptions="Center" HorizontalOptions="Start" Grid.Column="0" Margin="10,0,0,0" x:Name="ProfileImge"
                                                         BorderWidth="0" HeightRequest="50" WidthRequest="50" BackgroundColor="Transparent" CornerRadius="10"
                                                                 ImageSource="{Binding safePost.profile_picture, Converter={StaticResource isImageSourceConverter}}">
                                        <toolkitViews:AvatarView.Shadow>
                                            <Shadow Opacity="0.3"/>
                                        </toolkitViews:AvatarView.Shadow>

                                        <toolkitViews:AvatarView.Triggers>
                                            <DataTrigger
                                                                Binding="{Binding safePost.ghostModeEnabled}"
                                                                TargetType="toolkitViews:AvatarView"
                                                                Value="True">
                                                <Setter Property="IsVisible"
                                                                        Value="False"/>
                                            </DataTrigger>
                                        </toolkitViews:AvatarView.Triggers>
                                    </toolkitViews:AvatarView>

                                    <toolkitViews:AvatarView IsVisible="{Binding safePost.ghostModeEnabled}" VerticalOptions="Center" HorizontalOptions="Start" Grid.Column="0" Margin="10,0,0,0"
                                                         BorderWidth="0" HeightRequest="50" WidthRequest="50" BackgroundColor="Transparent" CornerRadius="10"
                                                                 ImageSource="https://cya.wagaana.com/images/default_profile.png">
                                        <toolkitViews:AvatarView.Shadow>
                                            <Shadow Opacity="0.3"/>
                                        </toolkitViews:AvatarView.Shadow>
                                    </toolkitViews:AvatarView>

                                    <StackLayout Orientation="Vertical"
                                                Margin="10,0,0,0">
                                        <Label FontAttributes="Bold">
                                            <Label.Text>
                                                <MultiBinding StringFormat="{}{0} {1} @{2}">
                                                    <Binding Path="safePost.name"/>
                                                    <Binding Path="dot"/>
                                                    <Binding Path="safePost.user_name"/>
                                                </MultiBinding>
                                            </Label.Text>

                                            <Label.Triggers>
                                                <DataTrigger
                                                        Binding="{Binding safePost.ghostModeEnabled}"
                                                        TargetType="Label"
                                                        Value="True">
                                                    <Setter Property="IsVisible"
                                                                Value="False"/>
                                                </DataTrigger>
                                            </Label.Triggers>
                                        </Label>
                                        <Label FontAttributes="Bold"
                                                    Text="Anonymous . @Anonymous"
                                                    IsVisible="{Binding safePost.ghostModeEnabled}"/>

                                        <Label
                                                FontAttributes="Bold"
                                                Text="{Binding safePost.created_at}"
                                                VerticalOptions="Center"
                                                Style="{StaticResource SubTextSemiBold}"/>
                                    </StackLayout>
                                </StackLayout>

                                <utils:LinksLabel Padding="5"
                                            Style="{StaticResource SubTextSemiBold}"
                                            LinksText="{Binding safePost.message}"/>

                                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                            HasShadow="True">
                                    <Grid>
                                        <Image
                                                IsVisible="{Binding safePost.isShowingImage}"
                                                Source="{Binding safePost.fileUrl, Converter={StaticResource isImageSourceConverter}}"
                                                HeightRequest="170"
                                                WidthRequest="130"
                                                Aspect="AspectFill">
                                        </Image>

                                        <Image
                                                IsVisible="{Binding safePost.isShowingVideo}"
                                                Source="{Binding safePost.videoId, StringFormat='https://img.youtube.com/vi/{0}/0.jpg'}"
                                                HeightRequest="170"
                                                WidthRequest="130"
                                                Aspect="AspectFill">
                                        </Image>

                                        <Image
                                                IsVisible="{Binding safePost.isShowingVideo}"
                                                Margin="0,0,0,0"
                                                Source="youtube.png"
                                                HeightRequest="50"
                                                WidthRequest="50"
                                                HorizontalOptions="CenterAndExpand"
                                                VerticalOptions="CenterAndExpand"/>
                                    </Grid>
                                </Frame>


                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <BoxView/>
                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                Padding="2,0,2,0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Label
                                                    Margin="0,0,0,0"
                                                    Style="{StaticResource SubTextSemiBold}"
                                                    VerticalOptions="Center"
                                                    HorizontalOptions="Start"
                                                    Text="{Binding safePost.likes}"
                                                    />
                                            <Label
                                                    Grid.Column="1"
                                                    Margin="5,0,0,0"
                                                    Style="{StaticResource SubTextSemiBold}"
                                                    VerticalOptions="Center"
                                                    Text="Likes"/>
                                        </Grid>
                                    </Frame>

                                    <BoxView Grid.Column="2"
                                                HorizontalOptions="End"/>
                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                Grid.Column="2"
                                                Padding="2,0,2,0"
                                                HorizontalOptions="End">
                                        <Grid>
                                            <Grid.GestureRecognizers>
                                                <TapGestureRecognizer
                                                        NumberOfTapsRequired="1"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=SafePostNavTap}"
                                                        CommandParameter="{Binding .}"/>
                                            </Grid.GestureRecognizers>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Label
                                                    Margin="0,0,0,0"
                                                    VerticalOptions="Center"
                                                    Style="{StaticResource SubTextSemiBold}"
                                                    Text="{Binding safePost.comments}"
                                                    
                                                    HorizontalOptions="End"/>
                                            <Label
                                                    Grid.Column="1"
                                                    Margin="5,0,0,0"
                                                    VerticalOptions="Center"
                                                    Style="{StaticResource SubTextSemiBold}"
                                                    Text="Comment"
                                                    HorizontalOptions="End"/>
                                        </Grid>
                                    </Frame>
                                </Grid>

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                Padding="2">
                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                    Padding="0,5,5,5"
                                                    >
                                            <Frame.GestureRecognizers>
                                                <TapGestureRecognizer
                                                        NumberOfTapsRequired="1"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=LikeSafePostNavTap}"
                                                        CommandParameter="{Binding safePost}"/>
                                            </Frame.GestureRecognizers>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Image
                                                        IsVisible="{Binding safePost.isUnLiked}"
                                                        Margin="0,0,0,0"
                                                        HorizontalOptions="Center"
                                                        Source="like.png"
                                                        HeightRequest="20"
                                                            WidthRequest="20"
                                                        VerticalOptions="Center"/>

                                                <Image
                                                        IsVisible="{Binding safePost.likedIt}"
                                                        Margin="0,0,0,0"
                                                        HorizontalOptions="Center"
                                                        Source="liked.png"
                                                        HeightRequest="20"
                                                            WidthRequest="20"
                                                        VerticalOptions="Center"/>

                                                <Label
                                                        Grid.Column="1"
                                                        Margin="5,0,0,0"
                                                        Style="{StaticResource SubTextSemiBold}"
                                                        VerticalOptions="Center"
                                                        Text="Like"
                                                        />
                                            </Grid>
                                        </Frame>
                                    </Frame>

                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                Grid.Column="1"
                                                Padding="2">
                                        <!--
                                            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10" Padding="5" >
                                                <Frame.GestureRecognizers>
                                                    <TapGestureRecognizer
                                                        NumberOfTapsRequired="1"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=SafePostNavTap}"
                                                        CommandParameter="{Binding safePost}"/>
                                                </Frame.GestureRecognizers>
                                                
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>

                                                    <Image
                                                         Margin="0,0,0,0"
                                                         HorizontalOptions="Center"
                                                         Source="chat.png"
                                                         HeightRequest="20" WidthRequest="20"
                                                         VerticalOptions="Center" />
                                                    <Label
                                                         Grid.Column="1"
                                                         Margin="5,0,0,0"
                                                         Style="{StaticResource SubTextSemiBold}"
                                                         VerticalOptions="Center"
                                                         Text="Comment"
                                                         />
                                                </Grid>
                                            </Frame>
                                            -->
                                    </Frame>

                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                Grid.Column="2"
                                                Padding="2">
                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                    Padding="5"
                                                    >
                                            <Frame.GestureRecognizers>
                                                <TapGestureRecognizer
                                                        NumberOfTapsRequired="1"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=ShareSafePostNavTap}"
                                                        CommandParameter="{Binding safePost}"/>
                                            </Frame.GestureRecognizers>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <Image
                                                        Margin="0,0,0,0"
                                                        HorizontalOptions="End"
                                                        Source="share.png"
                                                        HeightRequest="20"
                                                            WidthRequest="20"
                                                        VerticalOptions="Center"/>
                                                <Label
                                                        Grid.Column="1"
                                                        Margin="5,0,0,0"
                                                        VerticalOptions="Center"
                                                        Style="{StaticResource SubTextSemiBold}"
                                                        Text="Share"
                                                        
                                                        HorizontalOptions="End"/>
                                            </Grid>
                                        </Frame>
                                    </Frame>
                                </Grid>
                            </StackLayout>
                        </Frame>
                    </StackLayout>

                    <StackLayout Padding="10,0,10,0">
                        <Label Padding="10,0,10,0"
                                    Text="Discussion"
                                    HorizontalOptions="Start"
                                    
                                    Style="{StaticResource TabHeader}"/>
                    </StackLayout>

                    <StackLayout BindableLayout.ItemsSource="{Binding SafePosts}"
                                IsEnabled="False">
                        <BindableLayout.ItemTemplate>
                            <DataTemplate x:DataType="model:SafePost">
                                <StackLayout Padding="0,0,0,0"
                                            HorizontalOptions="FillAndExpand">

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <toolkitViews:AvatarView VerticalOptions="Start" HorizontalOptions="Start" Grid.Column="0" Margin="10,0,0,0" x:Name="ProfileImge"
                                                         BorderWidth="0" HeightRequest="50" WidthRequest="50" BackgroundColor="Transparent" CornerRadius="10"
                                                                 ImageSource="{Binding profile_picture, Converter={StaticResource isImageSourceConverter}}">
                                            <toolkitViews:AvatarView.Shadow>
                                                <Shadow Opacity="0.3"/>
                                            </toolkitViews:AvatarView.Shadow>

                                            <toolkitViews:AvatarView.Triggers>
                                                <DataTrigger Binding="{Binding ghostModeEnabled}" TargetType="toolkitViews:AvatarView" Value="True">
                                                    <Setter Property="IsVisible" Value="False"/>
                                                </DataTrigger>
                                            </toolkitViews:AvatarView.Triggers>
                                        </toolkitViews:AvatarView>

                                        <toolkitViews:AvatarView IsVisible="{Binding ghostModeEnabled}" VerticalOptions="Start" HorizontalOptions="Start" Grid.Column="0" Margin="10,0,0,0"
                                                         BorderWidth="0" HeightRequest="50" WidthRequest="50" BackgroundColor="Transparent" CornerRadius="10"
                                                                 ImageSource="https://cya.wagaana.com/images/default_profile.png">
                                            <toolkitViews:AvatarView.Shadow>
                                                <Shadow Opacity="0.3"/>
                                            </toolkitViews:AvatarView.Shadow>
                                        </toolkitViews:AvatarView>

                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}"
                                                   CornerRadius="10" HorizontalOptions="FillAndExpand" HasShadow="True" Margin="5" Grid.Column="1">
                                            <StackLayout Orientation="Vertical" Padding="5">
                                                <StackLayout Orientation="Vertical" Margin="0,0,0,0">
                                                    <Label FontAttributes="Bold">
                                                        <Label.Text>
                                                            <MultiBinding StringFormat="{}{0} {1} @{2}">
                                                                <Binding Path="name"/>
                                                                <Binding Path="dot"/>
                                                                <Binding Path="user_name"/>
                                                            </MultiBinding>
                                                        </Label.Text>

                                                        <Label.Triggers>
                                                            <DataTrigger Binding="{Binding ghostModeEnabled}" TargetType="Label" Value="True">
                                                                <Setter Property="IsVisible" Value="False"/>
                                                            </DataTrigger>
                                                        </Label.Triggers>
                                                    </Label>
                                                    <Label FontAttributes="Bold" Text="Anonymous . @Anonymous" IsVisible="{Binding ghostModeEnabled}"/>

                                                    <Label
                                                            FontAttributes="Bold"
                                                            Text="{Binding created_at}"
                                                            VerticalOptions="Center"
                                                            Style="{StaticResource SubTextSemiBold}"/>
                                                </StackLayout>

                                                <utils:LinksLabel Padding="5"
                                                            Style="{StaticResource SubTextSemiBold}"
                                                            LinksText="{Binding message}"/>

                                                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                            HasShadow="True">
                                                    <Grid>
                                                        <Image
                                                                IsVisible="{Binding isShowingImage}"
                                                                Source="{Binding fileUrl, Converter={StaticResource isImageSourceConverter}}"
                                                                HeightRequest="170"
                                                                WidthRequest="130"
                                                                Aspect="AspectFill">
                                                        </Image>

                                                        <Image
                                                                IsVisible="{Binding isShowingVideo}"
                                                                Source="{Binding videoId, StringFormat='https://img.youtube.com/vi/{0}/0.jpg'}"
                                                                HeightRequest="170"
                                                                WidthRequest="130"
                                                                Aspect="AspectFill">
                                                        </Image>

                                                        <Image
                                                                IsVisible="{Binding isShowingVideo}"
                                                                Margin="0,0,0,0"
                                                                Source="youtube.png"
                                                                HeightRequest="50"
                                                                WidthRequest="50"
                                                                HorizontalOptions="CenterAndExpand"
                                                                VerticalOptions="CenterAndExpand"/>
                                                    </Grid>
                                                </Frame>


                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="30"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>

                                                    <BoxView/>
                                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                Padding="2,0,2,0">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>

                                                            <Label
                                                                    Margin="0,0,0,0"
                                                                    Style="{StaticResource SubTextSemiBold}"
                                                                    VerticalOptions="Center"
                                                                    HorizontalOptions="Start"
                                                                    Text="{Binding likes}"
                                                                    />
                                                            <Label
                                                                    Grid.Column="1"
                                                                    Margin="5,0,0,0"
                                                                    Style="{StaticResource SubTextSemiBold}"
                                                                    VerticalOptions="Center"
                                                                    Text="Likes"/>
                                                        </Grid>
                                                    </Frame>

                                                    <BoxView Grid.Column="2"
                                                                HorizontalOptions="End"/>
                                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                Grid.Column="2"
                                                                Padding="0,0,2,0"
                                                                HorizontalOptions="End">
                                                        <Grid>
                                                            <Grid.GestureRecognizers>
                                                                <TapGestureRecognizer
                                                                        NumberOfTapsRequired="1"
                                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=SafePostNavTap}"
                                                                        CommandParameter="{Binding .}"/>
                                                            </Grid.GestureRecognizers>

                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>

                                                            <Label
                                                                    Margin="0,0,0,0"
                                                                    VerticalOptions="Center"
                                                                    Style="{StaticResource SubTextSemiBold}"
                                                                    Text="{Binding comments}"
                                                                    
                                                                    HorizontalOptions="End"/>
                                                            <Label
                                                                    Grid.Column="1"
                                                                    Margin="5,0,0,0"
                                                                    VerticalOptions="Center"
                                                                    Style="{StaticResource SubTextSemiBold}"
                                                                    Text="Comment"
                                                                    HorizontalOptions="End"/>
                                                        </Grid>
                                                    </Frame>
                                                </Grid>

                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="35"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>

                                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                Padding="2">
                                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                    Padding="0,5,5,5"
                                                                    >
                                                            <Frame.GestureRecognizers>
                                                                <TapGestureRecognizer
                                                                        NumberOfTapsRequired="1"
                                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=LikeSafePostNavTap}"
                                                                        CommandParameter="{Binding .}"/>
                                                            </Frame.GestureRecognizers>

                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>

                                                                <Image
                                                                        IsVisible="{Binding isUnLiked}"
                                                                        Margin="0,0,0,0"
                                                                        HorizontalOptions="Center"
                                                                        Source="like.png"
                                                                        HeightRequest="20"
                                                                            WidthRequest="20"
                                                                        VerticalOptions="Center"/>

                                                                <Image
                                                                        IsVisible="{Binding likedIt}"
                                                                        Margin="0,0,0,0"
                                                                        HorizontalOptions="Center"
                                                                        Source="liked.png"
                                                                        HeightRequest="20"
                                                                            WidthRequest="20"
                                                                        VerticalOptions="Center"/>

                                                                <Label
                                                                        Grid.Column="1"
                                                                        Margin="5,0,0,0"
                                                                        Style="{StaticResource SubTextSemiBold}"
                                                                        VerticalOptions="Center"
                                                                        Text="Like"
                                                                        />
                                                            </Grid>
                                                        </Frame>
                                                    </Frame>

                                                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                Grid.Column="1"
                                                                Padding="2">
                                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                    Padding="5"
                                                                    >
                                                            <Frame.GestureRecognizers>
                                                                <TapGestureRecognizer
                                                                        NumberOfTapsRequired="1"
                                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=SafePostNavTap}"
                                                                        CommandParameter="{Binding .}"/>
                                                            </Frame.GestureRecognizers>

                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>

                                                                <Image
                                                                        Margin="0,0,0,0"
                                                                        HorizontalOptions="Center"
                                                                        Source="chat.png"
                                                                        HeightRequest="20"
                                                                            WidthRequest="20"
                                                                        VerticalOptions="Center"/>
                                                                <Label
                                                                        Grid.Column="1"
                                                                        Margin="5,0,0,0"
                                                                        Style="{StaticResource SubTextSemiBold}"
                                                                        VerticalOptions="Center"
                                                                        Text="Comment"
                                                                        />
                                                            </Grid>
                                                        </Frame>
                                                    </Frame>

                                                    <Frame  BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                Grid.Column="2"
                                                                Padding="2">
                                                        <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource Background_Mid}}" CornerRadius="10"
                                                                    Padding="5"
                                                                    >
                                                            <Frame.GestureRecognizers>
                                                                <TapGestureRecognizer
                                                                        NumberOfTapsRequired="1"
                                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:PostDetailsViewModel}}, Path=ShareSafePostNavTap}"
                                                                        CommandParameter="{Binding .}"/>
                                                            </Frame.GestureRecognizers>

                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>

                                                                <Image
                                                                        Margin="0,0,0,0"
                                                                        HorizontalOptions="End"
                                                                        Source="share.png"
                                                                        HeightRequest="20"
                                                                            WidthRequest="20"
                                                                        VerticalOptions="Center"/>
                                                                <Label
                                                                        Grid.Column="1"
                                                                        Margin="5,0,0,0"
                                                                        VerticalOptions="Center"
                                                                        Style="{StaticResource SubTextSemiBold}"
                                                                        Text="Share"
                                                                        
                                                                        HorizontalOptions="End"/>
                                                            </Grid>
                                                        </Frame>
                                                    </Frame>
                                                </Grid>
                                            </StackLayout>
                                        </Frame>
                                    </Grid>
                                </StackLayout>
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>
                    </StackLayout>
                </StackLayout>
            </ScrollView>

            <!--  Message Entry  -->
            <Frame
                x:Name="AttachmentView"
                VerticalOptions="End"
                Padding="10"
                BackgroundColor="#eeeeee"
                BorderColor="Transparent"
                CornerRadius="20"
                Margin="10"
                IsVisible="False">

                <Grid ColumnSpacing="0"
                        RowSpacing="0"
                        HorizontalOptions="FillAndExpand">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Image
                        x:Name="NewImageView"
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="5"
                        BackgroundColor="Transparent"
                        HorizontalOptions="CenterAndExpand"
                        Source="file.png"
                        VerticalOptions="End"
                        WidthRequest="50"
                        HeightRequest="50"/>

                    <Label
                        x:Name="NewImageLabel"
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="5"
                        Padding="10,0,10,0"
                        Text="Discussion"
                        HorizontalOptions="Start"
                        
                        VerticalOptions="CenterAndExpand"/>
                </Grid>
            </Frame>

            <Grid ColumnSpacing="0" RowSpacing="0">
                <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>

                        <ImageButton
                            Grid.Column="0"
                            Margin="0,5,5,17"
                            BackgroundColor="Transparent"
                            Clicked="ShowAttachmentOptions"
                            HeightRequest="35"
                            HorizontalOptions="StartAndExpand"
                            Source="attachment.png"
                            VerticalOptions="End"/>

                        <Frame
                            Grid.Column="1"
                            Margin="0,0,0,10"
                            Padding="20,5,20,5"
                            BorderColor="Transparent"
                            CornerRadius="25"
                            MinimumHeightRequest="100"
                            VerticalOptions="End">

                            <Editor
                                x:Name="MessageEntry"
                                AutoSize="TextChanges"
                                Focused="ToggleSendButton"
                                FontSize="Small"
                                Keyboard="Chat"
                                MaxLength="240"
                                MinimumHeightRequest="50"
                                Placeholder="Write your message here..."
                                TextChanged="ToggleSendButton"
                                Text="{Binding ReplyTextMessage}"/>
                        </Frame>
                
                        <ImageButton
                            x:Name="SendButton"
                            Grid.Column="2"
                            Margin="5,0,5,17"
                            BackgroundColor="Transparent"
                            Command="{Binding SendPostCommand}"
                            HeightRequest="35"
                            HorizontalOptions="CenterAndExpand"
                            Rotation="45"
                            Source="send_disabled"
                            VerticalOptions="End"/>
                    </Grid>
                
        </StackLayout>
    </ContentPage.Content>
</ContentPage>